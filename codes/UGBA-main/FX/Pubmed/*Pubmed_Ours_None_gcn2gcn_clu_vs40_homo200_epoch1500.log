run_adaptive.py:8: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
  import imp
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=10, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
Using existing file ind.pubmed.x
Using existing file ind.pubmed.tx
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.allx
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.y
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.ty
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.ally
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.graph
Downloading https://github.com/kimiyoung/planetoid/raw/master/data/ind.pubmed.test.index
Processing...
Done!
#Attach Nodes:40
Length of training set: 3943
=== training gcn model ===
Epoch 0, training loss: 1.0969727039337158
acc_val: 0.4039
Epoch 10, training loss: 1.0288714170455933
acc_val: 0.6398
Epoch 20, training loss: 0.8768908977508545
acc_val: 0.6768
Epoch 30, training loss: 0.6742268204689026
acc_val: 0.7012
Epoch 40, training loss: 0.5647494196891785
acc_val: 0.8382
Epoch 50, training loss: 0.48397085070610046
acc_val: 0.8534
Epoch 60, training loss: 0.4659567177295685
acc_val: 0.8590
Epoch 70, training loss: 0.41173508763313293
acc_val: 0.8676
Epoch 80, training loss: 0.38856974244117737
acc_val: 0.8676
Epoch 90, training loss: 0.37637388706207275
acc_val: 0.8711
Epoch 100, training loss: 0.3615057170391083
acc_val: 0.8676
Epoch 110, training loss: 0.3480362296104431
acc_val: 0.8727
Epoch 120, training loss: 0.3445436358451843
acc_val: 0.8721
Epoch 130, training loss: 0.3361060619354248
acc_val: 0.8747
Epoch 140, training loss: 0.3327118456363678
acc_val: 0.8732
Epoch 150, training loss: 0.3277479112148285
acc_val: 0.8782
Epoch 160, training loss: 0.328731894493103
acc_val: 0.8757
Epoch 170, training loss: 0.30839887261390686
acc_val: 0.8737
Epoch 180, training loss: 0.29894810914993286
acc_val: 0.8747
Epoch 190, training loss: 0.3011929988861084
acc_val: 0.8757
=== picking the best model according to the performance on validation ===
Training encoder Finished!
Total time elapsed: 10.1855s
Encoder CA on clean test nodes: 0.8559
idx_sing_class [    0     1     4 ... 19700 19702 19704]
current_class_size 20
./selected_nodes/Pubmed/Seperate/seed10/class_1.txt
[ 5104. 15916. 14578. ...  4058.   903. 11450.]
idx_sing_class [    3     5     6 ... 19712 19714 19716]
current_class_size 20
./selected_nodes/Pubmed/Seperate/seed10/class_2.txt
[11009.  2782. 11343. ...  8626. 15548.  1205.]
idx_attach: tensor([ 5104, 15916, 14578,  9040, 14315, 14910,  7647,  7098, 11534,  7803,
        10837, 18637, 19544,   821,  4899, 18597, 14851,  9145, 13907, 10814,
        11009,  2782, 11343, 14528, 19272,  6196, 16600, 17595, 17660,  9488,
         2471,  3489,  7324, 19307,  7825,   688,  2799,  6114,  4498, 13749],
       device='cuda:0')
tensor([    1,     2,     3,  ..., 19712, 19714, 19716], device='cuda:0')
Epoch 0, loss_inner: 1.09870, loss_target: 1.08898, homo loss: 0.48479 
acc_train_clean: 0.3190, ASR_train_attach: 0.9000, ASR_train_outter: 0.1268
Epoch 10, loss_inner: 0.97819, loss_target: 0.87177, homo loss: 0.19416 
acc_train_clean: 0.6635, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 20, loss_inner: 0.87688, loss_target: 0.86135, homo loss: 0.03482 
acc_train_clean: 0.7550, ASR_train_attach: 0.4500, ASR_train_outter: 0.6757
Epoch 30, loss_inner: 0.73688, loss_target: 0.68144, homo loss: 0.00007 
acc_train_clean: 0.8007, ASR_train_attach: 0.8750, ASR_train_outter: 0.8315
Epoch 40, loss_inner: 0.60793, loss_target: 0.55415, homo loss: 0.00001 
acc_train_clean: 0.8379, ASR_train_attach: 0.9000, ASR_train_outter: 0.9348
Epoch 50, loss_inner: 0.52666, loss_target: 0.48967, homo loss: 0.00000 
acc_train_clean: 0.8466, ASR_train_attach: 0.9000, ASR_train_outter: 0.9511
Epoch 60, loss_inner: 0.48266, loss_target: 0.45081, homo loss: 0.00000 
acc_train_clean: 0.8537, ASR_train_attach: 0.9000, ASR_train_outter: 0.9511
Epoch 70, loss_inner: 0.45623, loss_target: 0.42435, homo loss: 0.00000 
acc_train_clean: 0.8620, ASR_train_attach: 0.9000, ASR_train_outter: 0.9529
Epoch 80, loss_inner: 0.43740, loss_target: 0.41220, homo loss: 0.00000 
acc_train_clean: 0.8671, ASR_train_attach: 0.8500, ASR_train_outter: 0.9167
Epoch 90, loss_inner: 0.42024, loss_target: 0.39083, homo loss: 0.00003 
acc_train_clean: 0.8694, ASR_train_attach: 0.9000, ASR_train_outter: 0.9438
Epoch 100, loss_inner: 0.47375, loss_target: 0.91016, homo loss: 0.02527 
acc_train_clean: 0.8707, ASR_train_attach: 0.1000, ASR_train_outter: 0.3062
Epoch 110, loss_inner: 0.40915, loss_target: 0.42392, homo loss: 0.00000 
acc_train_clean: 0.8714, ASR_train_attach: 0.7750, ASR_train_outter: 0.8678
Epoch 120, loss_inner: 0.39313, loss_target: 0.38404, homo loss: 0.00001 
acc_train_clean: 0.8752, ASR_train_attach: 0.8750, ASR_train_outter: 0.9384
Epoch 130, loss_inner: 0.38345, loss_target: 0.36733, homo loss: 0.00000 
acc_train_clean: 0.8773, ASR_train_attach: 0.9000, ASR_train_outter: 0.9638
Epoch 140, loss_inner: 0.37751, loss_target: 0.35016, homo loss: 0.00000 
acc_train_clean: 0.8780, ASR_train_attach: 0.9750, ASR_train_outter: 0.9692
Epoch 150, loss_inner: 0.37118, loss_target: 0.34012, homo loss: 0.00000 
acc_train_clean: 0.8800, ASR_train_attach: 0.9750, ASR_train_outter: 0.9746
Epoch 160, loss_inner: 0.36563, loss_target: 0.33523, homo loss: 0.00002 
acc_train_clean: 0.8813, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 170, loss_inner: 0.36208, loss_target: 0.33091, homo loss: 0.00003 
acc_train_clean: 0.8838, ASR_train_attach: 0.9250, ASR_train_outter: 0.9692
Epoch 180, loss_inner: 0.35857, loss_target: 0.32936, homo loss: 0.00002 
acc_train_clean: 0.8846, ASR_train_attach: 0.9750, ASR_train_outter: 0.9656
Epoch 190, loss_inner: 0.35523, loss_target: 0.32488, homo loss: 0.00000 
acc_train_clean: 0.8846, ASR_train_attach: 0.9250, ASR_train_outter: 0.9674
Epoch 200, loss_inner: 0.35451, loss_target: 0.35658, homo loss: 0.00054 
acc_train_clean: 0.8846, ASR_train_attach: 0.9750, ASR_train_outter: 0.9855
Epoch 210, loss_inner: 0.35559, loss_target: 0.36015, homo loss: 0.00000 
acc_train_clean: 0.8821, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 220, loss_inner: 0.35949, loss_target: 0.36041, homo loss: 0.00000 
acc_train_clean: 0.8813, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 230, loss_inner: 0.34799, loss_target: 0.32813, homo loss: 0.00000 
acc_train_clean: 0.8836, ASR_train_attach: 0.9750, ASR_train_outter: 0.9819
Epoch 240, loss_inner: 0.34275, loss_target: 0.31792, homo loss: 0.00000 
acc_train_clean: 0.8871, ASR_train_attach: 0.9500, ASR_train_outter: 0.9692
Epoch 250, loss_inner: 0.34156, loss_target: 0.31174, homo loss: 0.00000 
acc_train_clean: 0.8869, ASR_train_attach: 0.9750, ASR_train_outter: 0.9891
Epoch 260, loss_inner: 0.33904, loss_target: 0.30793, homo loss: 0.00000 
acc_train_clean: 0.8864, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 270, loss_inner: 0.33772, loss_target: 0.31091, homo loss: 0.00000 
acc_train_clean: 0.8874, ASR_train_attach: 0.9500, ASR_train_outter: 0.9656
Epoch 280, loss_inner: 0.33699, loss_target: 0.30844, homo loss: 0.00019 
acc_train_clean: 0.8892, ASR_train_attach: 0.9250, ASR_train_outter: 0.9728
Epoch 290, loss_inner: 0.61518, loss_target: 2.73752, homo loss: 0.04590 
acc_train_clean: 0.8851, ASR_train_attach: 0.0000, ASR_train_outter: 0.0036
Epoch 300, loss_inner: 0.35540, loss_target: 0.34209, homo loss: 0.00041 
acc_train_clean: 0.8882, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 310, loss_inner: 0.34285, loss_target: 0.33262, homo loss: 0.00000 
acc_train_clean: 0.8861, ASR_train_attach: 0.8750, ASR_train_outter: 0.9438
Epoch 320, loss_inner: 0.33497, loss_target: 0.31982, homo loss: 0.00000 
acc_train_clean: 0.8876, ASR_train_attach: 0.8750, ASR_train_outter: 0.9475
Epoch 330, loss_inner: 0.33293, loss_target: 0.31127, homo loss: 0.00000 
acc_train_clean: 0.8887, ASR_train_attach: 0.9500, ASR_train_outter: 0.9855
Epoch 340, loss_inner: 0.33081, loss_target: 0.30497, homo loss: 0.00002 
acc_train_clean: 0.8889, ASR_train_attach: 0.9250, ASR_train_outter: 0.9855
Epoch 350, loss_inner: 0.32873, loss_target: 0.30147, homo loss: 0.00000 
acc_train_clean: 0.8894, ASR_train_attach: 0.9250, ASR_train_outter: 0.9873
Epoch 360, loss_inner: 0.32761, loss_target: 0.29905, homo loss: 0.00000 
acc_train_clean: 0.8892, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 370, loss_inner: 0.32683, loss_target: 0.29819, homo loss: 0.00000 
acc_train_clean: 0.8899, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 380, loss_inner: 0.32613, loss_target: 0.29722, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 390, loss_inner: 0.32536, loss_target: 0.29707, homo loss: 0.00002 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 0.9819
Epoch 400, loss_inner: 0.32434, loss_target: 0.30076, homo loss: 0.00008 
acc_train_clean: 0.8904, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 410, loss_inner: 0.34715, loss_target: 0.41607, homo loss: 0.00000 
acc_train_clean: 0.8884, ASR_train_attach: 0.3250, ASR_train_outter: 0.5797
Epoch 420, loss_inner: 0.34088, loss_target: 0.38637, homo loss: 0.00000 
acc_train_clean: 0.8894, ASR_train_attach: 0.8000, ASR_train_outter: 0.8207
Epoch 430, loss_inner: 0.32697, loss_target: 0.31778, homo loss: 0.00000 
acc_train_clean: 0.8904, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 440, loss_inner: 0.32405, loss_target: 0.30314, homo loss: 0.00001 
acc_train_clean: 0.8884, ASR_train_attach: 0.8750, ASR_train_outter: 0.9674
Epoch 450, loss_inner: 0.32379, loss_target: 0.29583, homo loss: 0.00000 
acc_train_clean: 0.8904, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 460, loss_inner: 0.32194, loss_target: 0.29325, homo loss: 0.00002 
acc_train_clean: 0.8902, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 470, loss_inner: 0.32050, loss_target: 0.29171, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 0.9750, ASR_train_outter: 0.9855
Epoch 480, loss_inner: 0.32003, loss_target: 0.29095, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 490, loss_inner: 0.31973, loss_target: 0.29117, homo loss: 0.00011 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 500, loss_inner: 0.31979, loss_target: 0.30878, homo loss: 0.00516 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 510, loss_inner: 0.34993, loss_target: 0.33671, homo loss: 0.00019 
acc_train_clean: 0.8813, ASR_train_attach: 0.9000, ASR_train_outter: 0.9638
Epoch 520, loss_inner: 0.33683, loss_target: 0.32929, homo loss: 0.00000 
acc_train_clean: 0.8871, ASR_train_attach: 0.9250, ASR_train_outter: 0.9330
Epoch 530, loss_inner: 0.32346, loss_target: 0.31077, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 0.9500, ASR_train_outter: 0.9565
Epoch 540, loss_inner: 0.32030, loss_target: 0.30290, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 1.0000, ASR_train_outter: 0.9656
Epoch 550, loss_inner: 0.31977, loss_target: 0.29509, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 0.9801
Epoch 560, loss_inner: 0.31865, loss_target: 0.29169, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 570, loss_inner: 0.31741, loss_target: 0.29092, homo loss: 0.00000 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 580, loss_inner: 0.31703, loss_target: 0.28820, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 590, loss_inner: 0.31686, loss_target: 0.28851, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9855
Epoch 600, loss_inner: 0.31653, loss_target: 0.28766, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 610, loss_inner: 0.31619, loss_target: 0.28735, homo loss: 0.00005 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 620, loss_inner: 0.31914, loss_target: 0.33232, homo loss: 0.00116 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 630, loss_inner: 0.32051, loss_target: 0.30825, homo loss: 0.00001 
acc_train_clean: 0.8897, ASR_train_attach: 0.8500, ASR_train_outter: 0.9366
Epoch 640, loss_inner: 0.31750, loss_target: 0.29328, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 650, loss_inner: 0.31571, loss_target: 0.28833, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9819
Epoch 660, loss_inner: 0.31548, loss_target: 0.28648, homo loss: 0.00001 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 670, loss_inner: 0.31513, loss_target: 0.28602, homo loss: 0.00005 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 680, loss_inner: 0.38652, loss_target: 0.56969, homo loss: 0.00251 
acc_train_clean: 0.8866, ASR_train_attach: 0.2250, ASR_train_outter: 0.5833
Epoch 690, loss_inner: 0.33189, loss_target: 0.32214, homo loss: 0.00000 
acc_train_clean: 0.8950, ASR_train_attach: 0.9500, ASR_train_outter: 0.9547
Epoch 700, loss_inner: 0.32212, loss_target: 0.30466, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9500, ASR_train_outter: 0.9493
Epoch 710, loss_inner: 0.31781, loss_target: 0.29826, homo loss: 0.00001 
acc_train_clean: 0.8925, ASR_train_attach: 0.9250, ASR_train_outter: 0.9529
Epoch 720, loss_inner: 0.31684, loss_target: 0.29170, homo loss: 0.00001 
acc_train_clean: 0.8922, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 730, loss_inner: 0.31559, loss_target: 0.28798, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 740, loss_inner: 0.31563, loss_target: 0.29214, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 0.9000, ASR_train_outter: 0.9547
Epoch 750, loss_inner: 0.31431, loss_target: 0.28574, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 760, loss_inner: 0.31407, loss_target: 0.28462, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 770, loss_inner: 0.31371, loss_target: 0.28519, homo loss: 0.00003 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 780, loss_inner: 0.31498, loss_target: 0.29312, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 0.8500, ASR_train_outter: 0.9438
Epoch 790, loss_inner: 0.31387, loss_target: 0.28551, homo loss: 0.00009 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 800, loss_inner: 0.34159, loss_target: 0.38475, homo loss: 0.00092 
acc_train_clean: 0.8884, ASR_train_attach: 0.4000, ASR_train_outter: 0.6866
Epoch 810, loss_inner: 0.32908, loss_target: 0.33048, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 820, loss_inner: 0.32360, loss_target: 0.31775, homo loss: 0.00000 
acc_train_clean: 0.8904, ASR_train_attach: 0.9000, ASR_train_outter: 0.9384
Epoch 830, loss_inner: 0.31616, loss_target: 0.29613, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 0.9250, ASR_train_outter: 0.9348
Epoch 840, loss_inner: 0.31466, loss_target: 0.28636, homo loss: 0.00000 
acc_train_clean: 0.8953, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 850, loss_inner: 0.31436, loss_target: 0.28538, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 860, loss_inner: 0.31338, loss_target: 0.28340, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 870, loss_inner: 0.31291, loss_target: 0.28305, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9964
Epoch 880, loss_inner: 0.31274, loss_target: 0.28434, homo loss: 0.00007 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 890, loss_inner: 0.31431, loss_target: 0.32293, homo loss: 0.00091 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 900, loss_inner: 0.32647, loss_target: 0.34329, homo loss: 0.02615 
acc_train_clean: 0.8882, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 910, loss_inner: 0.32885, loss_target: 0.40598, homo loss: 0.00026 
acc_train_clean: 0.8859, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 920, loss_inner: 0.31606, loss_target: 0.31715, homo loss: 0.00000 
acc_train_clean: 0.8889, ASR_train_attach: 0.9500, ASR_train_outter: 0.9583
Epoch 930, loss_inner: 0.31710, loss_target: 0.30354, homo loss: 0.00000 
acc_train_clean: 0.8912, ASR_train_attach: 0.9000, ASR_train_outter: 0.9565
Epoch 940, loss_inner: 0.31685, loss_target: 0.29390, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9819
Epoch 950, loss_inner: 0.31479, loss_target: 0.28972, homo loss: 0.00001 
acc_train_clean: 0.8920, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 960, loss_inner: 0.31333, loss_target: 0.28825, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9819
Epoch 970, loss_inner: 0.31321, loss_target: 0.28863, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 980, loss_inner: 0.31337, loss_target: 0.28642, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 990, loss_inner: 0.31348, loss_target: 0.28739, homo loss: 0.00000 
acc_train_clean: 0.8953, ASR_train_attach: 1.0000, ASR_train_outter: 0.9819
Epoch 1000, loss_inner: 0.31308, loss_target: 0.28634, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 1010, loss_inner: 0.31306, loss_target: 0.28543, homo loss: 0.00004 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 1020, loss_inner: 0.31349, loss_target: 0.28956, homo loss: 0.00001 
acc_train_clean: 0.8935, ASR_train_attach: 0.9250, ASR_train_outter: 0.9692
Epoch 1030, loss_inner: 0.34629, loss_target: 0.38558, homo loss: 0.00000 
acc_train_clean: 0.8953, ASR_train_attach: 0.3000, ASR_train_outter: 0.6504
Epoch 1040, loss_inner: 0.32451, loss_target: 0.33572, homo loss: 0.00000 
acc_train_clean: 0.8904, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1050, loss_inner: 0.31687, loss_target: 0.30855, homo loss: 0.00006 
acc_train_clean: 0.8917, ASR_train_attach: 0.9750, ASR_train_outter: 0.9764
Epoch 1060, loss_inner: 0.31448, loss_target: 0.29788, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 0.9250, ASR_train_outter: 0.9837
Epoch 1070, loss_inner: 0.31489, loss_target: 0.29158, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 1.0000, ASR_train_outter: 0.9692
Epoch 1080, loss_inner: 0.31332, loss_target: 0.28727, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9855
Epoch 1090, loss_inner: 0.31225, loss_target: 0.28716, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1100, loss_inner: 0.31275, loss_target: 0.28899, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 1110, loss_inner: 0.31249, loss_target: 0.28490, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1120, loss_inner: 0.31252, loss_target: 0.28566, homo loss: 0.00001 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9728
Epoch 1130, loss_inner: 0.31213, loss_target: 0.28644, homo loss: 0.00009 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 1140, loss_inner: 0.32172, loss_target: 0.32369, homo loss: 0.00285 
acc_train_clean: 0.8937, ASR_train_attach: 0.6000, ASR_train_outter: 0.8062
Epoch 1150, loss_inner: 0.32664, loss_target: 0.33274, homo loss: 0.00144 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1160, loss_inner: 0.32040, loss_target: 0.33067, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 0.9500, ASR_train_outter: 0.9457
Epoch 1170, loss_inner: 0.31591, loss_target: 0.30945, homo loss: 0.00000 
acc_train_clean: 0.8907, ASR_train_attach: 0.9500, ASR_train_outter: 0.9656
Epoch 1180, loss_inner: 0.31529, loss_target: 0.29639, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9855
Epoch 1190, loss_inner: 0.31446, loss_target: 0.29071, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9764
Epoch 1200, loss_inner: 0.31303, loss_target: 0.28677, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1210, loss_inner: 0.31280, loss_target: 0.28969, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 1220, loss_inner: 0.31308, loss_target: 0.28598, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 1230, loss_inner: 0.31298, loss_target: 0.28805, homo loss: 0.00000 
acc_train_clean: 0.8909, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1240, loss_inner: 0.31335, loss_target: 0.28925, homo loss: 0.00001 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9801
Epoch 1250, loss_inner: 0.31408, loss_target: 0.28868, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9801
Epoch 1260, loss_inner: 0.31303, loss_target: 0.28840, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 1270, loss_inner: 0.31492, loss_target: 0.30896, homo loss: 0.00009 
acc_train_clean: 0.8899, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1280, loss_inner: 0.31955, loss_target: 0.31915, homo loss: 0.00003 
acc_train_clean: 0.8917, ASR_train_attach: 0.8000, ASR_train_outter: 0.8569
Epoch 1290, loss_inner: 0.31444, loss_target: 0.29327, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9601
Epoch 1300, loss_inner: 0.31324, loss_target: 0.28519, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 0.9750, ASR_train_outter: 0.9855
Epoch 1310, loss_inner: 0.31296, loss_target: 0.28536, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 0.9500, ASR_train_outter: 0.9674
Epoch 1320, loss_inner: 0.31792, loss_target: 0.41148, homo loss: 0.04028 
acc_train_clean: 0.8912, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1330, loss_inner: 0.35446, loss_target: 0.38032, homo loss: 0.00231 
acc_train_clean: 0.8844, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1340, loss_inner: 0.33960, loss_target: 0.34192, homo loss: 0.00005 
acc_train_clean: 0.8856, ASR_train_attach: 0.9500, ASR_train_outter: 0.9674
Epoch 1350, loss_inner: 0.32649, loss_target: 0.32936, homo loss: 0.00000 
acc_train_clean: 0.8882, ASR_train_attach: 0.9250, ASR_train_outter: 0.9475
Epoch 1360, loss_inner: 0.32188, loss_target: 0.31275, homo loss: 0.00001 
acc_train_clean: 0.8915, ASR_train_attach: 0.9500, ASR_train_outter: 0.9656
Epoch 1370, loss_inner: 0.31976, loss_target: 0.30233, homo loss: 0.00000 
acc_train_clean: 0.8917, ASR_train_attach: 0.9750, ASR_train_outter: 0.9728
Epoch 1380, loss_inner: 0.31770, loss_target: 0.29632, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 0.9764
Epoch 1390, loss_inner: 0.31604, loss_target: 0.29160, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 1400, loss_inner: 0.31528, loss_target: 0.29034, homo loss: 0.00008 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 1410, loss_inner: 0.31467, loss_target: 0.28841, homo loss: 0.00002 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 1420, loss_inner: 0.31451, loss_target: 0.28726, homo loss: 0.00001 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 1430, loss_inner: 0.31382, loss_target: 0.29496, homo loss: 0.00022 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1440, loss_inner: 0.31383, loss_target: 0.29366, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1450, loss_inner: 0.31348, loss_target: 0.28849, homo loss: 0.00009 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1460, loss_inner: 0.31458, loss_target: 0.31091, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 0.9750, ASR_train_outter: 0.9330
Epoch 1470, loss_inner: 0.31482, loss_target: 0.30166, homo loss: 0.00000 
acc_train_clean: 0.8927, ASR_train_attach: 0.8750, ASR_train_outter: 0.9565
Epoch 1480, loss_inner: 0.31526, loss_target: 0.29324, homo loss: 0.00345 
acc_train_clean: 0.8942, ASR_train_attach: 0.9000, ASR_train_outter: 0.9438
Epoch 1490, loss_inner: 0.31354, loss_target: 0.30869, homo loss: 0.00169 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 1500, loss_inner: 0.31584, loss_target: 0.30061, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 0.9500, ASR_train_outter: 0.9891
Epoch 1510, loss_inner: 0.31585, loss_target: 0.29532, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9746
Epoch 1520, loss_inner: 0.31431, loss_target: 0.29175, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 1530, loss_inner: 0.31452, loss_target: 0.28844, homo loss: 0.00000 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1540, loss_inner: 0.31486, loss_target: 0.28678, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1550, loss_inner: 0.31382, loss_target: 0.28572, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1560, loss_inner: 0.31337, loss_target: 0.28469, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1570, loss_inner: 0.31320, loss_target: 0.28410, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1580, loss_inner: 0.31277, loss_target: 0.28360, homo loss: 0.00001 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1590, loss_inner: 0.31260, loss_target: 0.28317, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1600, loss_inner: 0.31239, loss_target: 0.28273, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1610, loss_inner: 0.31226, loss_target: 0.28247, homo loss: 0.00001 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1620, loss_inner: 0.31219, loss_target: 0.28445, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 1.0000, ASR_train_outter: 0.9855
Epoch 1630, loss_inner: 0.31223, loss_target: 0.28345, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 1.0000, ASR_train_outter: 0.9909
Epoch 1640, loss_inner: 0.58262, loss_target: 2.41538, homo loss: 0.05616 
acc_train_clean: 0.8930, ASR_train_attach: 0.0000, ASR_train_outter: 0.0417
Epoch 1650, loss_inner: 0.33761, loss_target: 0.35214, homo loss: 0.00852 
acc_train_clean: 0.8897, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1660, loss_inner: 0.32386, loss_target: 0.32796, homo loss: 0.00002 
acc_train_clean: 0.8882, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 1670, loss_inner: 0.31762, loss_target: 0.30134, homo loss: 0.00000 
acc_train_clean: 0.8915, ASR_train_attach: 1.0000, ASR_train_outter: 0.9674
Epoch 1680, loss_inner: 0.31620, loss_target: 0.29249, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 0.9750, ASR_train_outter: 0.9873
Epoch 1690, loss_inner: 0.31471, loss_target: 0.28923, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1700, loss_inner: 0.31348, loss_target: 0.29135, homo loss: 0.00003 
acc_train_clean: 0.8937, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1710, loss_inner: 0.31341, loss_target: 0.28755, homo loss: 0.00003 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1720, loss_inner: 0.31291, loss_target: 0.29772, homo loss: 0.00001 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9982
Epoch 1730, loss_inner: 0.31244, loss_target: 0.28841, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1740, loss_inner: 0.31331, loss_target: 0.28652, homo loss: 0.00000 
acc_train_clean: 0.8948, ASR_train_attach: 1.0000, ASR_train_outter: 0.9855
Epoch 1750, loss_inner: 0.31344, loss_target: 0.28583, homo loss: 0.00005 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 1760, loss_inner: 0.31289, loss_target: 0.28490, homo loss: 0.00001 
acc_train_clean: 0.8948, ASR_train_attach: 1.0000, ASR_train_outter: 0.9891
Epoch 1770, loss_inner: 0.31260, loss_target: 0.28529, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1780, loss_inner: 0.34938, loss_target: 0.70077, homo loss: 0.05689 
acc_train_clean: 0.8849, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1790, loss_inner: 0.33538, loss_target: 0.41091, homo loss: 0.00496 
acc_train_clean: 0.8841, ASR_train_attach: 0.8750, ASR_train_outter: 0.9094
Epoch 1800, loss_inner: 0.32361, loss_target: 0.31904, homo loss: 0.00000 
acc_train_clean: 0.8897, ASR_train_attach: 0.9000, ASR_train_outter: 0.9620
Epoch 1810, loss_inner: 0.31963, loss_target: 0.30925, homo loss: 0.00000 
acc_train_clean: 0.8925, ASR_train_attach: 1.0000, ASR_train_outter: 0.9583
Epoch 1820, loss_inner: 0.31600, loss_target: 0.29951, homo loss: 0.00000 
acc_train_clean: 0.8920, ASR_train_attach: 1.0000, ASR_train_outter: 0.9837
Epoch 1830, loss_inner: 0.31415, loss_target: 0.29458, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 1840, loss_inner: 0.31383, loss_target: 0.29022, homo loss: 0.00000 
acc_train_clean: 0.8930, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1850, loss_inner: 0.31332, loss_target: 0.28662, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1860, loss_inner: 0.31289, loss_target: 0.28489, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1870, loss_inner: 0.31281, loss_target: 0.28397, homo loss: 0.00000 
acc_train_clean: 0.8940, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1880, loss_inner: 0.31272, loss_target: 0.28367, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1890, loss_inner: 0.31268, loss_target: 0.28326, homo loss: 0.00000 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1900, loss_inner: 0.31253, loss_target: 0.28306, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9928
Epoch 1910, loss_inner: 0.31245, loss_target: 0.28417, homo loss: 0.00001 
acc_train_clean: 0.8942, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1920, loss_inner: 0.31239, loss_target: 0.28446, homo loss: 0.00000 
acc_train_clean: 0.8945, ASR_train_attach: 1.0000, ASR_train_outter: 0.9946
Epoch 1930, loss_inner: 0.31256, loss_target: 0.28539, homo loss: 0.00014 
acc_train_clean: 0.8950, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
Epoch 1940, loss_inner: 0.31594, loss_target: 0.37602, homo loss: 0.00131 
acc_train_clean: 0.8927, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1950, loss_inner: 0.34032, loss_target: 0.35991, homo loss: 0.00042 
acc_train_clean: 0.8869, ASR_train_attach: 1.0000, ASR_train_outter: 1.0000
Epoch 1960, loss_inner: 0.33597, loss_target: 0.32194, homo loss: 0.00049 
acc_train_clean: 0.8856, ASR_train_attach: 0.9750, ASR_train_outter: 0.9783
Epoch 1970, loss_inner: 0.32334, loss_target: 0.31164, homo loss: 0.00000 
acc_train_clean: 0.8887, ASR_train_attach: 0.9750, ASR_train_outter: 0.9873
Epoch 1980, loss_inner: 0.32042, loss_target: 0.29803, homo loss: 0.00000 
acc_train_clean: 0.8935, ASR_train_attach: 1.0000, ASR_train_outter: 0.9819
Epoch 1990, loss_inner: 0.31794, loss_target: 0.29389, homo loss: 0.00000 
acc_train_clean: 0.8932, ASR_train_attach: 1.0000, ASR_train_outter: 0.9873
load best weight based on the loss outter
precent of left attach nodes: 1.000
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=265, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8534
Overall ASR: 0.9452
Flip ASR: 0.9324/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=125, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8554
Overall ASR: 0.9158
Flip ASR: 0.8996/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=996, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8534
Overall ASR: 0.9270
Flip ASR: 0.9093/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=527, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8519
Overall ASR: 0.8950
Flip ASR: 0.8732/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=320, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GCN', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8513
Overall ASR: 0.9397
Flip ASR: 0.9254/1554 nodes
Overall ASR: 0.9245 (GCN model, Seed: 320)
Overall Clean Accuracy: 0.8531
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=781, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
/home/xyl/lwj/ZS/BA/UGBA-main/models/GAT.py:61: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.labels = torch.tensor(labels, dtype=torch.long)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.8361
Overall ASR: 0.8276
Flip ASR: 0.7915/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=706, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9000
accuracy on clean test nodes: 0.8376
Overall ASR: 0.9102
Flip ASR: 0.8893/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=778, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8397
Overall ASR: 0.9209
Flip ASR: 0.9028/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=604, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8432
Overall ASR: 0.8068
Flip ASR: 0.7580/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=133, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GAT', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 1.0000
accuracy on clean test nodes: 0.8376
Overall ASR: 0.8347
Flip ASR: 0.7967/1554 nodes
Overall ASR: 0.8600 (GAT model, Seed: 133)
Overall Clean Accuracy: 0.8389
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=673, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.8600
Overall ASR: 0.9102
Flip ASR: 0.8900/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=904, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.8625
Overall ASR: 0.9077
Flip ASR: 0.8887/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=56, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9500
accuracy on clean test nodes: 0.8600
Overall ASR: 0.9102
Flip ASR: 0.8900/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=1, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.8605
Overall ASR: 0.9184
Flip ASR: 0.9015/1554 nodes
Namespace(cuda=True, dataset='Pubmed', debug=True, defense_mode='none', device_id=0, dis_weight=1, dropout=0.5, epochs=200, evaluate_mode='1by1', hidden=32, homo_boost_thrd=0.5, homo_loss_weight=100.0, inner=1, lr=0.01, model='GCN', no_cuda=False, prune_thr=0.2, seed=694, selection_method='cluster_degree', target_class=0, target_loss_weight=1, test_model='GraphSage', thrd=0.5, train_lr=0.01, trigger_size=3, trojan_epochs=2000, use_vs_number=True, vs_number=40, vs_ratio=0, weight_decay=0.0005)
target class rate on Vs: 0.9750
accuracy on clean test nodes: 0.8610
Overall ASR: 0.9042
Flip ASR: 0.8848/1554 nodes
Overall ASR: 0.9101 (GraphSage model, Seed: 694)
Overall Clean Accuracy: 0.8608
Total Overall ASR: 0.8982 
Total Clean Accuracy: 0.8509
